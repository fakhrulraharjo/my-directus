"use strict";class t{constructor(t){this.data=t}translation(t,e){let n=0;if(t)return t.forEach(((t,o)=>{var i,l;(null==(i=t.languages_id)?void 0:i.code)!=e&&(null==(l=t.languages_code)?void 0:l.code)!=e||(n=o)})),t[n]}convButton(t,e){const n=this.translation(t.translations,e);return{text:(null==n?void 0:n.text)||"Learn More",link:t.link}}convFaq(t,e){return((t,e)=>{let n=null;return 0!=t.length&&t?(n=[],t.forEach((t=>{const o=this.translation(t.item.translations,e);null==n||n.push({question:(null==o?void 0:o.question)||"",answer:(null==o?void 0:o.answer)||"",title:t.item.title})})),{list:n}):n})(t.faqs,e)}convHero(t,e){const n=this.translation(t.translations,e);return{position:t.position,image:{id:t.image.id,width:t.image.width,height:t.image.height,title:t.image.title},title:(null==n?void 0:n.title)||null,content:(null==n?void 0:n.content)||null,button:(t=>{let n=null;return 0!=t.length&&t?(n=[],t.forEach((t=>{null==n||n.push(this.convButton(t.item,e))})),n):n})(t.button),list:(null==n?void 0:n.list)?n.list.map((t=>t.item)):void 0,background_color:t.background_colour}}convHorizontalList(t,e){let n={list:[]};return t.hero.forEach((t=>{n.list.push(this.convHero(t.item,e))})),n}print(t){const e=this.data[0];if(!e)return null;let n={id:e.id,slug:e.slug,name:e.name,component:[]};return e.components.forEach((e=>{let o={};switch(e.collection){case"hero":o.type=e.collection,o={...o,...this.convHero(e.item,t)};break;case"horizontal_list":o.type=e.collection,o={...o,...this.convHorizontalList(e.item,t)};break;case"buttons":o.type=e.collection,o={...o,...this.convButton(e.item,t)};break;case"faq_components":o.type=e.collection,o={...o,...this.convFaq(e.item,t)}}n.component.push(o)})),n}}var e=(e,{services:n,exceptions:o})=>{const{ItemsService:i}=n,{ServiceUnavailableException:l}=o;e.get("/:slug",((e,n,o)=>{const s=new i("pages",{schema:e.schema,accountability:e.accountability});let a=e.query.language;s.readByQuery({sort:["name"],fields:["*.*.*.*.*.*.*.*"],filter:{slug:{_eq:e.params.slug}},limit:1}).then((e=>{let i=new t(e);return e.length>0?n.json(i.print(a)):o(new l("Not Found"))})).catch((t=>o(new l(t.message))))}))};module.exports=e;
